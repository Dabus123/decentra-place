"use strict";(self.webpackChunkan_onchain_app_in_100_components=self.webpackChunkan_onchain_app_in_100_components||[]).push([[6983],{"./node_modules/@paperxyz/embedded-wallet-service-sdk/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{PaperEmbeddedWalletSdk:()=>N,Q:()=>w,_O:()=>H});var n,t,a,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@paperxyz/sdk-common-utilities/dist/index.mjs"),_ethersproject_providers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@ethersproject/providers/lib.esm/index.js"),_ethersproject_abstract_signer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@ethersproject/abstract-signer/lib.esm/index.js"),_ethersproject_properties__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@ethersproject/properties/lib.esm/index.js"),z=Object.defineProperty,q=Object.defineProperties,Z=Object.getOwnPropertyDescriptors,x=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable,k=(s,e,t)=>e in s?z(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,u=(s,e)=>{for(var t in e||(e={}))$.call(e,t)&&k(s,t,e[t]);if(x)for(var t of x(e))B.call(e,t)&&k(s,t,e[t]);return s},y=(s,e)=>q(s,Z(e)),i=(s,e,t)=>new Promise(((r,a)=>{var o=l=>{try{d(t.next(l))}catch(p){a(p)}},n=l=>{try{d(t.throw(l))}catch(p){a(p)}},d=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,n);d((t=t.apply(s,e)).next())})),E="/sdk/2022-08-12/embedded-wallet",L=s=>`paperEwsWalletUserId-${s}`,I=s=>`walletToken-${s}`,W=(s,e)=>`a-${s}-${e}`,w=((t=w||{}).USER_MANAGED="USER_MANAGED",t.AWS_MANAGED="AWS_MANAGED",t),Y=((n=Y||{}).PAPER_EMAIL_OTP="PaperEmailOTP",n.GOOGLE="Google",n.TWITTER="Twitter",n.COGNITO="Cognito",n.AUTH0="Auth0",n.CUSTOM_JWT="CustomJWT",n),H=(t=>(t.LOGGED_OUT="Logged Out",t.LOGGED_IN_WALLET_INITIALIZED="Logged In, Wallet Initialized",t))(H||{}),P=((a=P||{}).LOGGED_OUT="Logged Out",a.LOGGED_IN_WALLET_UNINITIALIZED="Logged In, Wallet Uninitialized",a.LOGGED_IN_NEW_DEVICE="Logged In, New Device",a.LOGGED_IN_WALLET_INITIALIZED="Logged In, Wallet Initialized",a),F=new Map,h=class{constructor({clientId:e}){this.isSupported="undefined"!=typeof window&&!!window.localStorage,this.clientId=e}getItem(e){return i(this,null,(function*(){var t;return this.isSupported?window.localStorage.getItem(e):null!=(t=F.get(e))?t:null}))}setItem(e,t){return i(this,null,(function*(){if(this.isSupported)return window.localStorage.setItem(e,t);F.set(e,t)}))}removeItem(e){return i(this,null,(function*(){let t=yield this.getItem(e);return!(!this.isSupported||!t)&&(window.localStorage.removeItem(e),!0)}))}saveAuthCookie(e){return i(this,null,(function*(){yield this.setItem(I(this.clientId),e)}))}getAuthCookie(){return i(this,null,(function*(){return this.getItem(I(this.clientId))}))}removeAuthCookie(){return i(this,null,(function*(){return this.removeItem(I(this.clientId))}))}saveDeviceShare(e,t){return i(this,null,(function*(){yield this.saveWalletUserId(t),yield this.setItem(W(this.clientId,t),e)}))}getDeviceShare(){return i(this,null,(function*(){let e=yield this.getWalletUserId();return e?this.getItem(W(this.clientId,e)):null}))}removeDeviceShare(){return i(this,null,(function*(){let e=yield this.getWalletUserId();return!!e&&this.removeItem(W(this.clientId,e))}))}getWalletUserId(){return i(this,null,(function*(){return this.getItem(L(this.clientId))}))}saveWalletUserId(e){return i(this,null,(function*(){yield this.setItem(L(this.clientId),e)}))}removeWalletUserId(){return i(this,null,(function*(){return this.removeItem(L(this.clientId))}))}};function v(s){return new Promise((e=>{setTimeout(e,1e3*s)}))}var ee={height:"100%",width:"100%",border:"none",backgroundColor:"transparent",colorScheme:"light",position:"fixed",top:"0px",right:"0px",zIndex:"2147483646",display:"none"},G=new Map,f=class{constructor({link:e,iframeId:t,container:r=document.body,iframeStyles:a,onIframeInitialize:o}){this.POLLING_INTERVAL_SECONDS=1.4,this.POST_LOAD_BUFFER_SECONDS=1;let n=document.getElementById(t),d=new URL(e),l="1.2.5";if(d.searchParams.set("sdkVersion",l),!n||n.src!=d.href){if(!n){n=document.createElement("iframe");let p=u(u({},ee),a);Object.assign(n.style,p),n.setAttribute("id",t),n.setAttribute("fetchpriority","high"),r.appendChild(n)}n.src=d.href,n.setAttribute("data-version",l),n.onload=this.onIframeLoadHandler(n,this.POST_LOAD_BUFFER_SECONDS,o)}this.iframe=n}onIframeLoadedInitVariables(){return i(this,null,(function*(){return{}}))}onIframeLoadHandler(e,t,r){return()=>i(this,null,(function*(){yield new Promise(((o,n)=>i(this,null,(function*(){var p;let d=new MessageChannel;d.port1.onmessage=m=>{let{data:c}=m;return d.port1.close(),c.success?(G.set(e.src,!0),r&&r(),o(!0)):n(new Error(c.error))},yield v(t);null==(p=null==e?void 0:e.contentWindow)||p.postMessage({eventType:"initIframe",data:yield this.onIframeLoadedInitVariables()},`${(0,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.mb)()}${E}`,[d.port2])}))))}))}call(o){return i(this,arguments,(function*({procedureName:e,params:t,showIframe:r=!1,injectRecoveryCode:a={isInjectRecoveryCode:!1}}){for(;!G.get(this.iframe.src);)yield v(this.POLLING_INTERVAL_SECONDS);return r&&(this.iframe.style.display="block",yield v(.005)),new Promise(((d,l)=>{var m;if(a.isInjectRecoveryCode){let c=g=>i(this,null,(function*(){var U,b;if(g.origin!==(0,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.mb)()||"paper_getRecoveryCode"!==g.data.type||"string"!=typeof g.data.userWalletId)return;let V=yield null==(U=a.getRecoveryCode)?void 0:U.call(a,g.data.userWalletId);null==(b=this.iframe.contentWindow)||b.postMessage({type:"paper_getRecoveryCode_response",recoveryCode:V},(0,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.mb)()),window.removeEventListener("message",c)}));window.addEventListener("message",c)}let p=new MessageChannel;p.port1.onmessage=c=>i(this,null,(function*(){let{data:g}=c;p.port1.close(),r&&(yield v(.1),this.iframe.style.display="none"),g.success?d(g.data):l(new Error(g.error))})),null==(m=this.iframe.contentWindow)||m.postMessage({eventType:e,data:t},`${(0,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.mb)()}${E}`,[p.port2])}))}))}destroy(){G.delete(this.iframe.src)}},_=class extends f{constructor({clientId:t,customizationOptions:r}){super({iframeId:ie,link:re({clientId:t,path:E,queryParams:r}).href,container:document.body}),this.clientId=t}onIframeLoadedInitVariables(){return i(this,null,(function*(){let t=new h({clientId:this.clientId});return{authCookie:yield t.getAuthCookie(),deviceShareStored:yield t.getDeviceShare(),walletUserId:yield t.getWalletUserId(),clientId:this.clientId}}))}};function re({clientId:s,path:e,queryParams:t}){var a;let r=new URL(e,(0,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.mb)());if(t)for(let o of Object.keys(t))r.searchParams.set(o,(null==(a=t[o])?void 0:a.toString())||"");return r.searchParams.set("clientId",s),r}var ie="paper-embedded-wallet-iframe",A=class{constructor({querier:e,preLogin:t,postLogin:r,clientId:a}){this.LoginQuerier=e,this.preLogin=t,this.postLogin=r,this.clientId=a}sendPaperEmailLoginOtp(r){return i(this,arguments,(function*({email:e,recoveryShareManagement:t}){yield this.preLogin();let{isNewUser:a,isNewDevice:o,recoveryShareManagement:n}=yield this.LoginQuerier.call({procedureName:"sendPaperEmailLoginOtp",params:{email:e,recoveryShareManagement:t}});return{isNewUser:a,isNewDevice:o,recoveryShareManagement:n}}))}},C=class extends A{constructor(){super(...arguments),this.closeWindow=({isWindowOpenedByFn:t,win:r,closeOpenedWindow:a})=>{t?null==r||r.close():r&&a?a(r):r&&r.close()}}loginWithPaperModal(){return i(this,null,(function*(){yield this.preLogin();let t=yield this.LoginQuerier.call({procedureName:"loginWithPaperModal",params:{recoveryShareManagement:"AWS_MANAGED"},showIframe:!0,injectRecoveryCode:{isInjectRecoveryCode:!0}});return this.postLogin(t)}))}getGoogleLoginUrl(){return i(this,null,(function*(){return yield this.LoginQuerier.call({procedureName:"getHeadlessGoogleLoginLink",params:void 0})}))}loginWithGoogle(t){return i(this,null,(function*(){yield this.preLogin();let r=null==t?void 0:t.openedWindow,a=!1;if(r||(r=window.open("","Login","width=350, height=500"),a=!0),!r)throw new Error("Something went wrong opening pop-up");yield this.preLogin();let{loginLink:o}=yield this.getGoogleLoginUrl();r.location.href=o;let n=yield new Promise(((d,l)=>{let p=window.setInterval((()=>i(this,null,(function*(){r&&r.closed&&(clearInterval(p),window.removeEventListener("message",m),l(new Error("User closed login window")))}))),1e3),m=c=>i(this,null,(function*(){if(c.origin===(0,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.mb)()){if("object"!=typeof c.data)return void l(new Error("Invalid event data"));switch(c.data.eventType){case"userLoginSuccess":window.removeEventListener("message",m),clearInterval(p),this.closeWindow({isWindowOpenedByFn:a,win:r,closeOpenedWindow:null==t?void 0:t.closeOpenedWindow}),c.data.authResult&&d(c.data.authResult);break;case"userLoginFailed":window.removeEventListener("message",m),clearInterval(p),this.closeWindow({isWindowOpenedByFn:a,win:r,closeOpenedWindow:null==t?void 0:t.closeOpenedWindow}),l(new Error(c.data.error));break;case"injectDeveloperClientId":null==r||r.postMessage({eventType:"injectDeveloperClientIdResult",developerClientId:this.clientId},(0,_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.mb)())}}}));window.addEventListener("message",m)}));return this.postLogin({storedToken:y(u({},n.storedToken),{shouldStoreCookieString:!0}),walletDetails:y(u({},n.walletDetails),{isIframeStorageEnabled:!1})})}))}loginWithPaperEmailOtp(r){return i(this,arguments,(function*({email:t}){yield this.preLogin();let a=yield this.LoginQuerier.call({procedureName:"loginWithPaperModal",params:{email:t,recoveryShareManagement:"AWS_MANAGED"},showIframe:!0,injectRecoveryCode:{isInjectRecoveryCode:!0}});return this.postLogin(a)}))}verifyPaperEmailLoginOtp(a){return i(this,arguments,(function*({email:t,otp:r}){let o=yield this.LoginQuerier.call({procedureName:"verifyPaperEmailLoginOtp",params:{email:t,otp:r,recoveryShareManagement:"AWS_MANAGED"},injectRecoveryCode:{isInjectRecoveryCode:!0}});return this.postLogin(o)}))}},D=class extends A{loginWithPaperModal(e){return i(this,null,(function*(){yield this.preLogin();let t=yield this.LoginQuerier.call({procedureName:"loginWithPaperModal",params:void 0,showIframe:!0,injectRecoveryCode:{isInjectRecoveryCode:!0,getRecoveryCode:null==e?void 0:e.getRecoveryCode}});return this.postLogin(t)}))}loginWithGoogle(e){return i(this,null,(function*(){throw new Error("loginWithGoogle is not yet supported in the RecoveryShareManagement.USER_MANAGED flow. Please use RecoveryShareManagement.AWS_MANAGED instead.")}))}loginWithPaperEmailOtp(r){return i(this,arguments,(function*({email:e,recoveryCode:t}){yield this.preLogin();let a=yield this.LoginQuerier.call({procedureName:"loginWithPaperModal",params:{email:e,recoveryCode:t},showIframe:!0,injectRecoveryCode:{isInjectRecoveryCode:!0}});return this.postLogin(a)}))}verifyPaperEmailLoginOtp(a){return i(this,arguments,(function*({email:e,otp:t,recoveryCode:r}){let o=yield this.LoginQuerier.call({procedureName:"verifyPaperEmailLoginOtp",params:{email:e,otp:t,recoveryCode:r},injectRecoveryCode:{isInjectRecoveryCode:!0}});return this.postLogin(o)}))}},M=class{constructor({clientId:e,advancedOptions:t,querier:r,onAuthSuccess:a}){var o;this.clientId=e,this.advancedOptions={recoveryShareManagement:null!=(o=null==t?void 0:t.recoveryShareManagement)?o:"AWS_MANAGED"},this.AuthQuerier=r,this.localStorage=new h({clientId:e}),this.onAuthSuccess=a,this.userManagedLogin=new D({postLogin:n=>i(this,null,(function*(){return this.postLogin(n)})),preLogin:()=>i(this,null,(function*(){yield this.preLogin()})),querier:r,clientId:e}),this.awsManagedLogin=new C({postLogin:n=>i(this,null,(function*(){return this.postLogin(n)})),preLogin:()=>i(this,null,(function*(){yield this.preLogin()})),querier:r,clientId:e})}preLogin(){return i(this,null,(function*(){yield this.logout()}))}postLogin(r){return i(this,arguments,(function*({storedToken:e,walletDetails:t}){return e.shouldStoreCookieString&&(yield this.localStorage.saveAuthCookie(e.cookieString)),yield this.onAuthSuccess({storedToken:e,walletDetails:t})}))}loginWithJwtAuth(a){return i(this,arguments,(function*({token:e,authProvider:t,recoveryCode:r}){yield this.preLogin();let o=yield this.AuthQuerier.call({procedureName:"loginWithJwtAuthCallback",params:{token:e,authProvider:t,recoveryCode:r}});return this.postLogin(o)}))}loginWithPaperModal(e){return i(this,null,(function*(){return yield this.preLogin(),"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.loginWithPaperModal():this.userManagedLogin.loginWithPaperModal(e)}))}loginWithPaperEmailOtp(e){return i(this,null,(function*(){return"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.loginWithPaperEmailOtp({email:e.email}):this.userManagedLogin.loginWithPaperEmailOtp(e)}))}loginWithGoogle(e){return i(this,null,(function*(){return"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.loginWithGoogle(e):this.userManagedLogin.loginWithGoogle()}))}sendPaperEmailLoginOtp(t){return i(this,arguments,(function*({email:e}){return"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.sendPaperEmailLoginOtp({email:e,recoveryShareManagement:"AWS_MANAGED"}):this.userManagedLogin.sendPaperEmailLoginOtp({email:e})}))}verifyPaperEmailLoginOtp(e){return i(this,null,(function*(){return"AWS_MANAGED"===this.advancedOptions.recoveryShareManagement?this.awsManagedLogin.verifyPaperEmailLoginOtp(e):this.userManagedLogin.verifyPaperEmailLoginOtp(e)}))}logout(){return i(this,null,(function*(){let{success:e}=yield this.AuthQuerier.call({procedureName:"logout",params:void 0}),t=yield this.localStorage.removeAuthCookie(),r=yield this.localStorage.removeWalletUserId();return{success:e||t||r}}))}},R=class{constructor({chain:e,clientId:t,querier:r}){this.chain=e,this.clientId=t,this.gaslessTransactionQuerier=r}callContract(a){return i(this,arguments,(function*({contractAddress:e,methodArgs:t,methodInterface:r}){return yield this.gaslessTransactionQuerier.call({procedureName:"callContract",params:{chain:this.chain,contractAddress:e,method:{args:t,stub:r}}})}))}},T=class extends _ethersproject_abstract_signer__WEBPACK_IMPORTED_MODULE_1__.Signer{constructor({provider:t,clientId:r,querier:a}){var o;super(),this.DEFAULT_ETHEREUM_CHAIN_ID=5,this.clientId=r,this.querier=a,this.endpoint=null==(o=t.connection)?void 0:o.url,(0,_ethersproject_properties__WEBPACK_IMPORTED_MODULE_2__.defineReadOnly)(this,"provider",t)}getAddress(){return i(this,null,(function*(){let{address:t}=yield this.querier.call({procedureName:"getAddress",params:void 0});return t}))}signMessage(t){return i(this,null,(function*(){var o,n,d,l;let r=yield null==(o=this.provider)?void 0:o.getNetwork();r&&r._defaultProvider;let{signedMessage:a}=yield this.querier.call({procedureName:"signMessage",params:{message:t,chainId:null!=(l=null==(d=yield null==(n=this.provider)?void 0:n.getNetwork())?void 0:d.chainId)?l:this.DEFAULT_ETHEREUM_CHAIN_ID,rpcEndpoint:this.endpoint}});return a}))}signTransaction(t){return i(this,null,(function*(){var a,o,n;let{signedTransaction:r}=yield this.querier.call({procedureName:"signTransaction",params:{transaction:t,chainId:null!=(n=null==(o=yield null==(a=this.provider)?void 0:a.getNetwork())?void 0:o.chainId)?n:this.DEFAULT_ETHEREUM_CHAIN_ID,rpcEndpoint:this.endpoint}});return r}))}_signTypedData(t,r,a){return i(this,null,(function*(){var n,d,l;let{signedTypedData:o}=yield this.querier.call({procedureName:"signTypedDataV4",params:{domain:t,types:r,message:a,chainId:null!=(l=null==(d=yield null==(n=this.provider)?void 0:n.getNetwork())?void 0:d.chainId)?l:this.DEFAULT_ETHEREUM_CHAIN_ID,rpcEndpoint:this.endpoint}});return o}))}connect(t){return new T({clientId:this.clientId,provider:t,querier:this.querier})}},O=class{constructor({clientId:e,chain:t,querier:r}){this.clientId=e,this.chain=t,this.walletManagerQuerier=r,this.gasless=new R({chain:t,clientId:e,querier:r}),this.localStorage=new h({clientId:e})}postWalletSetUp(o){return i(this,arguments,(function*({deviceShareStored:e,walletAddress:t,isIframeStorageEnabled:r,walletUserId:a}){return r||(yield this.localStorage.saveDeviceShare(e,a)),{walletAddress:t}}))}getUserWalletStatus(){return i(this,null,(function*(){let e=yield this.walletManagerQuerier.call({procedureName:"getUserStatus",params:void 0});return"Logged In, Wallet Initialized"===e.status?{status:"Logged In, Wallet Initialized",user:y(u({},e.user),{wallet:this})}:e}))}setChain(t){return i(this,arguments,(function*({chain:e}){this.chain=e,this.gasless=new R({chain:e,clientId:this.clientId,querier:this.walletManagerQuerier})}))}getEthersJsSigner(e){return i(this,null,(function*(){var r;return new T({clientId:this.clientId,provider:(0,_ethersproject_providers__WEBPACK_IMPORTED_MODULE_3__.getDefaultProvider)(null!=(r=null==e?void 0:e.rpcEndpoint)?r:_paperxyz_sdk_common_utilities__WEBPACK_IMPORTED_MODULE_0__.J6[this.chain]),querier:this.walletManagerQuerier})}))}},N=class{constructor({clientId:e,chain:t,styles:r,advancedOptions:a,onAuthSuccess:o}){this.clientId=e,this.querier=new _({clientId:e,customizationOptions:r}),this.wallet=new O({clientId:e,chain:t,querier:this.querier}),this.auth=new M({clientId:e,advancedOptions:u({recoveryShareManagement:"USER_MANAGED"},null!=a?a:{}),querier:this.querier,onAuthSuccess:n=>i(this,null,(function*(){return yield this.wallet.postWalletSetUp(y(u({},n.walletDetails),{walletUserId:n.storedToken.authDetails.userWalletId})),yield this.querier.call({procedureName:"initIframe",params:{deviceShareStored:n.walletDetails.deviceShareStored,clientId:this.clientId,walletUserId:n.storedToken.authDetails.userWalletId,authCookie:n.storedToken.cookieString}}),null==o||o(n),{user:{status:"Logged In, Wallet Initialized",authDetails:n.storedToken.authDetails,wallet:this.wallet,walletAddress:n.walletDetails.walletAddress}}}))})}getUser(){return i(this,null,(function*(){let e=yield this.wallet.getUserWalletStatus();switch(e.status){case"Logged In, New Device":case"Logged In, Wallet Uninitialized":return yield this.auth.logout(),this.getUser();case"Logged Out":return{status:"Logged Out"};case"Logged In, Wallet Initialized":return u({status:"Logged In, Wallet Initialized"},e.user)}}))}}},"./node_modules/@thirdweb-dev/wallets/dist/normalizeChainId-1fb9aedf.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function normalizeChainId(chainId){return"string"==typeof chainId?Number.parseInt(chainId,"0x"===chainId.trim().substring(0,2)?16:10):"bigint"==typeof chainId?Number(chainId):chainId}__webpack_require__.d(__webpack_exports__,{n:()=>normalizeChainId})},"./node_modules/@thirdweb-dev/wallets/evm/connectors/paper/dist/thirdweb-dev-wallets-evm-connectors-paper.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{PaperWalletConnector:()=>PaperWalletConnector});var _dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@thirdweb-dev/wallets/dist/defineProperty-350fc508.browser.esm.js"),_paperxyz_embedded_wallet_service_sdk__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@paperxyz/embedded-wallet-service-sdk/dist/index.mjs"),ethers__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@ethersproject/address/lib.esm/index.js"),_dist_normalizeChainId_1fb9aedf_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@thirdweb-dev/wallets/dist/normalizeChainId-1fb9aedf.browser.esm.js"),_dist_walletIds_dff6dced_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@thirdweb-dev/wallets/dist/walletIds-dff6dced.browser.esm.js"),_dist_connector_05689d68_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@thirdweb-dev/wallets/dist/connector-05689d68.browser.esm.js");__webpack_require__("./node_modules/eventemitter3/index.mjs");class PaperWalletConnector extends _dist_connector_05689d68_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.C{constructor(options){super(),(0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__._)(this,"id",_dist_walletIds_dff6dced_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.w.paper),(0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__._)(this,"name","Paper Wallet"),(0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__._)(this,"ready",!0),(0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__._)(this,"user",null),(0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__._)(this,"onAccountsChanged",(async accounts=>{0===accounts.length?await this.onDisconnect():this.emit("change",{account:ethers__WEBPACK_IMPORTED_MODULE_5__.getAddress(accounts[0])})})),(0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__._)(this,"onChainChanged",(chainId=>{const id=(0,_dist_normalizeChainId_1fb9aedf_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.n)(chainId),unsupported=-1===this.options.chains.findIndex((c=>c.chainId===id));this.emit("change",{chain:{id,unsupported}})})),(0,_dist_defineProperty_350fc508_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__._)(this,"onDisconnect",(async()=>{this.emit("disconnect")})),this.options=options}getPaperSDK(){return this.paper||(this.paper=new Promise((async(resolve,reject)=>{const recoveryMethod=this.options.advancedOptions?.recoveryShareManagement;try{const{PaperEmbeddedWalletSdk}=await Promise.resolve().then(__webpack_require__.bind(__webpack_require__,"./node_modules/@paperxyz/embedded-wallet-service-sdk/dist/index.mjs")),methodToEnum={AWS_MANAGED:_paperxyz_embedded_wallet_service_sdk__WEBPACK_IMPORTED_MODULE_0__.Q.AWS_MANAGED,USER_MANAGED:_paperxyz_embedded_wallet_service_sdk__WEBPACK_IMPORTED_MODULE_0__.Q.USER_MANAGED};resolve(new PaperEmbeddedWalletSdk({advancedOptions:{recoveryShareManagement:recoveryMethod?methodToEnum[recoveryMethod]:void 0},clientId:this.options.clientId,chain:"Ethereum",styles:this.options.styles,onAuthSuccess:this.options.onAuthSuccess}))}catch(err){reject(err)}}))),this.paper}async connect(options){const paperSDK=await this.getPaperSDK();if(!paperSDK)throw new Error("Paper SDK not initialized");const user=await paperSDK.getUser();switch(user.status){case _paperxyz_embedded_wallet_service_sdk__WEBPACK_IMPORTED_MODULE_0__._O.LOGGED_OUT:{let authResult;if(options?.googleLogin){const arg=options.googleLogin;authResult=await paperSDK.auth.loginWithGoogle("object"==typeof arg?arg:void 0)}else authResult=options?.email&&options?.otp?await paperSDK.auth.verifyPaperEmailLoginOtp({email:options.email,otp:options.otp,recoveryCode:options.recoveryCode}):options?.email?await paperSDK.auth.loginWithPaperEmailOtp({email:options.email}):await paperSDK.auth.loginWithPaperModal();this.user=authResult.user;break}case _paperxyz_embedded_wallet_service_sdk__WEBPACK_IMPORTED_MODULE_0__._O.LOGGED_IN_WALLET_INITIALIZED:"object"==typeof options?.googleLogin&&options.googleLogin.closeOpenedWindow&&options.googleLogin.openedWindow&&options.googleLogin.closeOpenedWindow(options.googleLogin.openedWindow),this.user=user}if(!this.user)throw new Error("Error connecting User");return options?.chainId&&this.switchChain(options.chainId),this.setupListeners(),this.getAddress()}async disconnect(){const paper=await this.paper;await(paper?.auth.logout()),this._signer=void 0,this.user=null}async getAddress(){return(await this.getSigner()).getAddress()}async isConnected(){try{return!!await this.getAddress()}catch(e){return!1}}async getProvider(){const signer=await this.getSigner();if(!signer.provider)throw new Error("Provider not found");return signer.provider}async getSigner(){if(this._signer)return this._signer;if(!this.user){const paperSDK=await this.getPaperSDK(),user=await paperSDK.getUser();if(user.status===_paperxyz_embedded_wallet_service_sdk__WEBPACK_IMPORTED_MODULE_0__._O.LOGGED_IN_WALLET_INITIALIZED)this.user=user}const signer=await(this.user?.wallet.getEthersJsSigner({rpcEndpoint:this.options.chain.rpc[0]||""}));if(!signer)throw new Error("Signer not found");return this._signer=signer,signer}async isAuthorized(){return!1}async switchChain(chainId){const chain=this.options.chains.find((c=>c.chainId===chainId));if(!chain)throw new Error("Chain not configured");await(this.user?.wallet.setChain({chain:"Ethereum"})),this._signer=await(this.user?.wallet.getEthersJsSigner({rpcEndpoint:chain.rpc[0]||""})),this.emit("change",{chain:{id:chainId,unsupported:!1}})}async setupListeners(){const provider=await this.getProvider();provider.on&&(provider.on("accountsChanged",this.onAccountsChanged),provider.on("chainChanged",this.onChainChanged),provider.on("disconnect",this.onDisconnect))}updateChains(chains){this.options.chains=chains}async getEmail(){if(await this.getProvider(),!this.user)throw new Error("No user found, Paper Wallet is not connected");return this.user.authDetails.email}}}}]);