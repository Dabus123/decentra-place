"use strict";(self.webpackChunkan_onchain_app_in_100_components=self.webpackChunkan_onchain_app_in_100_components||[]).push([[809],{"./node_modules/@thirdweb-dev/sdk/dist/contract-interceptor-d7b164a7.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>ContractInterceptor});class ContractInterceptor{constructor(contractWrapper){this.contractWrapper=contractWrapper}overrideNextTransaction(hook){this.contractWrapper.withTransactionOverride(hook)}}},"./node_modules/@thirdweb-dev/sdk/dist/split-eb66a32f.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Split:()=>Split});var ethers__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@ethersproject/bignumber/lib.esm/bignumber.js"),ethers__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@ethersproject/contracts/lib.esm/index.js"),_fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/fetchCurrencyValue-32d08b05.browser.esm.js"),_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/index-33cd3415.browser.esm.js"),_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/transactions-72f9603c.browser.esm.js"),_contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/contract-appuri-5c40af52.browser.esm.js"),_contract_interceptor_d7b164a7_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/contract-interceptor-d7b164a7.browser.esm.js"),_contract_roles_71988d2e_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/contract-roles-71988d2e.browser.esm.js");__webpack_require__("./node_modules/bn.js/lib/bn.js"),__webpack_require__("./node_modules/bs58/index.js"),__webpack_require__("./node_modules/eventemitter3/index.mjs");class Split{static contractRoles=_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.dM;get chainId(){return this._chainId}constructor(network,address,storage){let options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},abi=arguments.length>4?arguments[4]:void 0,chainId=arguments.length>5?arguments[5]:void 0,contractWrapper=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.cs(network,address,abi,options,storage);this._chainId=chainId,this.abi=_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.bj.parse(abi||[]),this.contractWrapper=contractWrapper,this.storage=storage,this.metadata=new _contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.C(this.contractWrapper,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.c7,this.storage),this.app=new _contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.b(this.contractWrapper,this.metadata,this.storage),this.roles=new _contract_roles_71988d2e_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.C(this.contractWrapper,Split.contractRoles),this.encoder=new _fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.C(this.contractWrapper),this.estimator=new _contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.G(this.contractWrapper),this.events=new _contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.a(this.contractWrapper),this.interceptor=new _contract_interceptor_d7b164a7_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__.C(this.contractWrapper)}onNetworkUpdated(network){this.contractWrapper.updateSignerOrProvider(network)}getAddress(){return this.contractWrapper.address}async getAllRecipients(){const recipients=[];let index=ethers__WEBPACK_IMPORTED_MODULE_8__.gH.from(0);const totalRecipients=await this.contractWrapper.read("payeeCount",[]);for(;index.lt(totalRecipients);)try{const recipientAddress=await this.contractWrapper.read("payee",[index]);recipients.push(await this.getRecipientSplitPercentage(recipientAddress)),index=index.add(1)}catch(err){if("method"in err&&err.method.toLowerCase().includes("payee(uint256)"))break;throw err}return recipients}async balanceOfAllRecipients(){const recipients=await this.getAllRecipients(),balances={};for(const recipient of recipients)balances[recipient.address]=await this.balanceOf(recipient.address);return balances}async balanceOfTokenAllRecipients(tokenAddress){const[resolvedToken,recipients]=await Promise.all([(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(tokenAddress),this.getAllRecipients()]),balances={};for(const recipient of recipients)balances[recipient.address]=await this.balanceOfToken(recipient.address,resolvedToken);return balances}async balanceOf(address){const[resolvedAddress,walletBalance,totalReleased]=await Promise.all([(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(address),this.contractWrapper.getProvider().getBalance(this.getAddress()),this.contractWrapper.read("totalReleased",[])]),totalReceived=walletBalance.add(totalReleased);return this._pendingPayment(resolvedAddress,totalReceived,await this.contractWrapper.read("released",[resolvedAddress]))}async balanceOfToken(walletAddress,tokenAddress){const[resolvedToken,resolvedWallet]=await Promise.all([(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(tokenAddress),(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(walletAddress)]),ERC20Abi=(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC20.json",19))).default,erc20=new ethers__WEBPACK_IMPORTED_MODULE_9__.NZ(resolvedToken,ERC20Abi,this.contractWrapper.getProvider()),[walletBalance,totalReleased,alreadyReleased]=await Promise.all([erc20.balanceOf(this.getAddress()),this.contractWrapper.read("totalReleased",[resolvedToken]),this.contractWrapper.read("released",[resolvedToken,resolvedWallet])]),totalReceived=walletBalance.add(totalReleased),value=await this._pendingPayment(resolvedWallet,totalReceived,alreadyReleased);return await(0,_fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.a)(this.contractWrapper.getProvider(),resolvedToken,value)}async getRecipientSplitPercentage(address){const[resolvedAddress,totalShares,walletsShares]=await Promise.all([(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(address),this.contractWrapper.read("totalShares",[]),this.contractWrapper.read("shares",[address])]);return{address:resolvedAddress,splitPercentage:walletsShares.mul(ethers__WEBPACK_IMPORTED_MODULE_8__.gH.from(1e7)).div(totalShares).toNumber()/1e5}}withdraw=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.f)((async walletAddress=>_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"release(address)",args:[await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(walletAddress)]})));withdrawToken=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.f)((async(walletAddress,tokenAddress)=>_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"release(address,address)",args:await Promise.all([(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(tokenAddress),(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(walletAddress)])})));distribute=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.f)((async()=>_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"distribute()",args:[]})));distributeToken=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.f)((async tokenAddress=>_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"distribute(address)",args:[await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(tokenAddress)]})));async _pendingPayment(address,totalReceived,alreadyReleased){const[resolvedAddress,totalShares]=await Promise.all([(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.aL)(address),this.contractWrapper.read("totalShares",[])]);return totalReceived.mul(await this.contractWrapper.read("shares",[resolvedAddress])).div(totalShares).sub(alreadyReleased)}async prepare(method,args,overrides){return _transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_10__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method,args,overrides})}async call(functionName,args,overrides){return this.contractWrapper.call(functionName,args,overrides)}}}}]);