"use strict";(self.webpackChunkan_onchain_app_in_100_components=self.webpackChunkan_onchain_app_in_100_components||[]).push([[3666],{"./node_modules/@thirdweb-dev/sdk/dist/erc-721-standard-4c4125d2.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>StandardErc721});var _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/index-33cd3415.browser.esm.js"),_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/transactions-72f9603c.browser.esm.js"),_erc_721_27306550_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/erc-721-27306550.browser.esm.js");class StandardErc721{get chainId(){return this._chainId}constructor(contractWrapper,storage,chainId){this.contractWrapper=contractWrapper,this.storage=storage,this.erc721=new _erc_721_27306550_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.E(this.contractWrapper,this.storage,chainId),this._chainId=chainId}onNetworkUpdated(network){this.contractWrapper.updateSignerOrProvider(network)}getAddress(){return this.contractWrapper.address}async getAll(queryParams){return this.erc721.getAll(queryParams)}async getOwned(walletAddress,queryParams){return walletAddress&&(walletAddress=await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.aL)(walletAddress)),this.erc721.getOwned(walletAddress,queryParams)}async getOwnedTokenIds(walletAddress){return walletAddress&&(walletAddress=await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.aL)(walletAddress)),this.erc721.getOwnedTokenIds(walletAddress)}async totalSupply(){return this.erc721.totalCirculatingSupply()}async get(tokenId){return this.erc721.get(tokenId)}async ownerOf(tokenId){return this.erc721.ownerOf(tokenId)}async balanceOf(address){return this.erc721.balanceOf(address)}async balance(){return this.erc721.balance()}async isApproved(address,operator){return this.erc721.isApproved(address,operator)}transfer=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.f)((async(to,tokenId)=>this.erc721.transfer.prepare(to,tokenId)));setApprovalForAll=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.f)((async(operator,approved)=>this.erc721.setApprovalForAll.prepare(operator,approved)));setApprovalForToken=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.f)((async(operator,tokenId)=>_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"approve",args:[await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.aL)(operator),tokenId]})))}},"./node_modules/@thirdweb-dev/sdk/dist/hasERC20Allowance-654a940b.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{h:()=>hasERC20Allowance});var _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/index-33cd3415.browser.esm.js");async function hasERC20Allowance(contractToApprove,currencyAddress,value){const provider=contractToApprove.getProvider(),ERC20Abi=(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC20.json",19))).default,erc20=new _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.cs(provider,currencyAddress,ERC20Abi,{},contractToApprove.storage),owner=await contractToApprove.getSignerAddress(),spender=contractToApprove.address;return(await erc20.read("allowance",[owner,spender])).gte(value)}},"./node_modules/@thirdweb-dev/sdk/dist/marketplace-e3129e2f.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>isWinningBid,g:()=>getAllInBatches,h:()=>handleTokenApproval,i:()=>isTokenApprovedForTransfer,m:()=>mapOffer,v:()=>validateNewListingParam});var ethers__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@ethersproject/contracts/lib.esm/index.js"),ethers__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@ethersproject/bignumber/lib.esm/bignumber.js"),tiny_invariant__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/tiny-invariant/dist/esm/tiny-invariant.js"),_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/QueryParams-32a56510.browser.esm.js"),_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/index-33cd3415.browser.esm.js"),_fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/fetchCurrencyValue-32d08b05.browser.esm.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");async function isTokenApprovedForTransfer(provider,transferrerContractAddress,assetContract,tokenId,owner){try{const ERC165Abi=(await __webpack_require__.e(4811).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC165.json",19))).default,erc165=new ethers__WEBPACK_IMPORTED_MODULE_0__.NZ(assetContract,ERC165Abi,provider),[isERC721,isERC1155]=await Promise.all([erc165.supportsInterface(_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.I),erc165.supportsInterface(_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.a)]);if(isERC721){const ERC721Abi=(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC721.json",19))).default,asset=new ethers__WEBPACK_IMPORTED_MODULE_0__.NZ(assetContract,ERC721Abi,provider);if(await asset.isApprovedForAll(owner,transferrerContractAddress))return!0;let approvedAddress;try{approvedAddress=await asset.getApproved(tokenId)}catch(e){}return approvedAddress?.toLowerCase()===transferrerContractAddress.toLowerCase()}if(isERC1155){const ERC1155Abi=(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC1155.json",19))).default,asset=new ethers__WEBPACK_IMPORTED_MODULE_0__.NZ(assetContract,ERC1155Abi,provider);return await asset.isApprovedForAll(owner,transferrerContractAddress)}return console.error("Contract does not implement ERC 1155 or ERC 721."),!1}catch(err){return console.error("Failed to check if token is approved",err),!1}}async function handleTokenApproval(contractWrapper,marketplaceAddress,assetContract,tokenId,from){const ERC165Abi=(await __webpack_require__.e(4811).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC165.json",19))).default,erc165=new _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.cs(contractWrapper.getSignerOrProvider(),assetContract,ERC165Abi,contractWrapper.options,contractWrapper.storage),[isERC721,isERC1155]=await Promise.all([erc165.read("supportsInterface",[_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.I]),erc165.read("supportsInterface",[_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.a])]);if(isERC721){const ERC721Abi=(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC721.json",19))).default,asset=new _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.cs(contractWrapper.getSignerOrProvider(),assetContract,ERC721Abi,contractWrapper.options,contractWrapper.storage);if(!await asset.read("isApprovedForAll",[from,marketplaceAddress])){(await asset.read("getApproved",[tokenId])).toLowerCase()===marketplaceAddress.toLowerCase()||await asset.sendTransaction("setApprovalForAll",[marketplaceAddress,!0])}}else{if(!isERC1155)throw Error("Contract must implement ERC 1155 or ERC 721.");{const ERC1155Abi=(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC1155.json",19))).default,asset=new _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.cs(contractWrapper.getSignerOrProvider(),assetContract,ERC1155Abi,contractWrapper.options,contractWrapper.storage);await asset.read("isApprovedForAll",[from,marketplaceAddress])||await asset.sendTransaction("setApprovalForAll",[marketplaceAddress,!0])}}}function validateNewListingParam(param){if((0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__.A)(void 0!==param.assetContractAddress&&null!==param.assetContractAddress,"Asset contract address is required"),(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__.A)(void 0!==param.buyoutPricePerToken&&null!==param.buyoutPricePerToken,"Buyout price is required"),(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__.A)(void 0!==param.listingDurationInSeconds&&null!==param.listingDurationInSeconds,"Listing duration is required"),(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__.A)(void 0!==param.startTimestamp&&null!==param.startTimestamp,"Start time is required"),(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__.A)(void 0!==param.tokenId&&null!==param.tokenId,"Token ID is required"),(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__.A)(void 0!==param.quantity&&null!==param.quantity,"Quantity is required"),"NewAuctionListing"===param.type)(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__.A)(void 0!==param.reservePricePerToken&&null!==param.reservePricePerToken,"Reserve price is required")}async function mapOffer(provider,listingId,offer){return{quantity:offer.quantityDesired,pricePerToken:offer.pricePerToken,currencyContractAddress:offer.currency,buyerAddress:offer.offeror,quantityDesired:offer.quantityWanted,currencyValue:await(0,_fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.a)(provider,offer.currency,offer.quantityWanted.mul(offer.pricePerToken)),listingId}}function isWinningBid(winningPrice,newBidPrice,bidBuffer){if(bidBuffer=ethers__WEBPACK_IMPORTED_MODULE_5__.gH.from(bidBuffer),winningPrice=ethers__WEBPACK_IMPORTED_MODULE_5__.gH.from(winningPrice),newBidPrice=ethers__WEBPACK_IMPORTED_MODULE_5__.gH.from(newBidPrice),winningPrice.eq(ethers__WEBPACK_IMPORTED_MODULE_5__.gH.from(0)))return!1;return newBidPrice.sub(winningPrice).mul(_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.dE).div(winningPrice).gte(bidBuffer)}async function getAllInBatches(start,end,fn){const batches=[];for(;end-start>_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.D;)batches.push(fn(start,start+_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.D-1)),start+=_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.D;return batches.push(fn(start,end-1)),await Promise.all(batches)}},"./node_modules/@thirdweb-dev/sdk/dist/multiwrap-2e713f6c.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Multiwrap:()=>Multiwrap});var ethers__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@ethersproject/units/lib.esm/index.js"),_fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/fetchCurrencyValue-32d08b05.browser.esm.js"),_hasERC20Allowance_654a940b_browser_esm_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/hasERC20Allowance-654a940b.browser.esm.js"),_normalizePriceValue_9851c0eb_browser_esm_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/normalizePriceValue-9851c0eb.browser.esm.js"),_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/index-33cd3415.browser.esm.js"),_marketplace_e3129e2f_browser_esm_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/marketplace-e3129e2f.browser.esm.js"),_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/QueryParams-32a56510.browser.esm.js"),_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/transactions-72f9603c.browser.esm.js"),_contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/contract-appuri-5c40af52.browser.esm.js"),_contract_owner_49e75547_browser_esm_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/contract-owner-49e75547.browser.esm.js"),_contract_roles_71988d2e_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/contract-roles-71988d2e.browser.esm.js"),_erc_721_standard_4c4125d2_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/erc-721-standard-4c4125d2.browser.esm.js");__webpack_require__("./node_modules/bn.js/lib/bn.js"),__webpack_require__("./node_modules/bs58/index.js"),__webpack_require__("./node_modules/eventemitter3/index.mjs"),__webpack_require__("./node_modules/fast-deep-equal/index.js");class Multiwrap extends _erc_721_standard_4c4125d2_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.S{static contractRoles=_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.dI;constructor(network,address,storage){let options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},abi=arguments.length>4?arguments[4]:void 0,chainId=arguments.length>5?arguments[5]:void 0;super(arguments.length>6&&void 0!==arguments[6]?arguments[6]:new _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.cs(network,address,abi,options,storage),storage,chainId),this.abi=_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.bj.parse(abi||[]),this.metadata=new _contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.C(this.contractWrapper,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.dJ,this.storage),this.app=new _contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.b(this.contractWrapper,this.metadata,this.storage),this.roles=new _contract_roles_71988d2e_browser_esm_js__WEBPACK_IMPORTED_MODULE_7__.C(this.contractWrapper,Multiwrap.contractRoles),this.encoder=new _fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_8__.C(this.contractWrapper),this.estimator=new _contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.G(this.contractWrapper),this.events=new _contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_6__.a(this.contractWrapper),this.royalties=new _contract_owner_49e75547_browser_esm_js__WEBPACK_IMPORTED_MODULE_9__.C(this.contractWrapper,this.metadata),this.owner=new _contract_owner_49e75547_browser_esm_js__WEBPACK_IMPORTED_MODULE_9__.a(this.contractWrapper)}async getWrappedContents(wrappedTokenId){const wrappedTokens=await this.contractWrapper.read("getWrappedContents",[wrappedTokenId]),erc20Tokens=[],erc721Tokens=[],erc1155Tokens=[];for(const token of wrappedTokens)switch(token.tokenType){case 0:{const tokenMetadata=await(0,_fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_8__.f)(this.contractWrapper.getProvider(),token.assetContract);erc20Tokens.push({contractAddress:token.assetContract,quantity:ethers__WEBPACK_IMPORTED_MODULE_10__.formatUnits(token.totalAmount,tokenMetadata.decimals)});break}case 1:erc721Tokens.push({contractAddress:token.assetContract,tokenId:token.tokenId});break;case 2:erc1155Tokens.push({contractAddress:token.assetContract,tokenId:token.tokenId,quantity:token.totalAmount.toString()})}return{erc20Tokens,erc721Tokens,erc1155Tokens}}wrap=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_11__.f)((async(contents,wrappedTokenMetadata,recipientAddress)=>{const[uri,tokens,recipient]=await Promise.all([(0,_QueryParams_32a56510_browser_esm_js__WEBPACK_IMPORTED_MODULE_12__.b)(wrappedTokenMetadata,this.storage),this.toTokenStructList(contents),(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.aL)(recipientAddress||await this.contractWrapper.getSignerAddress())]);return _transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_11__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"wrap",args:[tokens,uri,recipient],parse:receipt=>{const event=this.contractWrapper.parseLogs("TokensWrapped",receipt?.logs);if(0===event.length)throw new Error("TokensWrapped event not found");const tokenId=event[0].args.tokenIdOfWrappedToken;return{id:tokenId,receipt,data:()=>this.get(tokenId)}}})}));unwrap=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_11__.f)((async(wrappedTokenId,recipientAddress)=>{const recipient=await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_5__.aL)(recipientAddress||await this.contractWrapper.getSignerAddress());return _transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_11__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"unwrap",args:[wrappedTokenId,recipient]})}));async toTokenStructList(contents){const tokens=[],provider=this.contractWrapper.getProvider(),owner=await this.contractWrapper.getSignerAddress();if(contents.erc20Tokens)for(const erc20 of contents.erc20Tokens){const normalizedQuantity=await(0,_normalizePriceValue_9851c0eb_browser_esm_js__WEBPACK_IMPORTED_MODULE_13__.n)(provider,erc20.quantity,erc20.contractAddress);if(!await(0,_hasERC20Allowance_654a940b_browser_esm_js__WEBPACK_IMPORTED_MODULE_14__.h)(this.contractWrapper,erc20.contractAddress,normalizedQuantity))throw new Error(`ERC20 token with contract address "${erc20.contractAddress}" does not have enough allowance to transfer.\n\nYou can set allowance to the multiwrap contract to transfer these tokens by running:\n\nawait sdk.getToken("${erc20.contractAddress}").setAllowance("${this.getAddress()}", ${erc20.quantity});\n\n`);tokens.push({assetContract:erc20.contractAddress,totalAmount:normalizedQuantity,tokenId:0,tokenType:0})}if(contents.erc721Tokens)for(const erc721 of contents.erc721Tokens){if(!await(0,_marketplace_e3129e2f_browser_esm_js__WEBPACK_IMPORTED_MODULE_15__.i)(this.contractWrapper.getProvider(),this.getAddress(),erc721.contractAddress,erc721.tokenId,owner))throw new Error(`ERC721 token "${erc721.tokenId}" with contract address "${erc721.contractAddress}" is not approved for transfer.\n\nYou can give approval the multiwrap contract to transfer this token by running:\n\nawait sdk.getNFTCollection("${erc721.contractAddress}").setApprovalForToken("${this.getAddress()}", ${erc721.tokenId});\n\n`);tokens.push({assetContract:erc721.contractAddress,totalAmount:0,tokenId:erc721.tokenId,tokenType:1})}if(contents.erc1155Tokens)for(const erc1155 of contents.erc1155Tokens){if(!await(0,_marketplace_e3129e2f_browser_esm_js__WEBPACK_IMPORTED_MODULE_15__.i)(this.contractWrapper.getProvider(),this.getAddress(),erc1155.contractAddress,erc1155.tokenId,owner))throw new Error(`ERC1155 token "${erc1155.tokenId}" with contract address "${erc1155.contractAddress}" is not approved for transfer.\n\nYou can give approval the multiwrap contract to transfer this token by running:\n\nawait sdk.getEdition("${erc1155.contractAddress}").setApprovalForAll("${this.getAddress()}", true);\n\n`);tokens.push({assetContract:erc1155.contractAddress,totalAmount:erc1155.quantity,tokenId:erc1155.tokenId,tokenType:2})}return tokens}async prepare(method,args,overrides){return _transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_11__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method,args,overrides})}async call(functionName,args,overrides){return this.contractWrapper.call(functionName,args,overrides)}}}}]);