"use strict";(self.webpackChunkan_onchain_app_in_100_components=self.webpackChunkan_onchain_app_in_100_components||[]).push([[522],{"./node_modules/@thirdweb-dev/sdk/dist/contract-appuri-5c40af52.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>ContractMetadata,G:()=>GasCostEstimator,a:()=>ContractEvents,b:()=>ContractAppURI,d:()=>detectContractFeature,h:()=>hasFunction});var _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/index-33cd3415.browser.esm.js"),_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/transactions-72f9603c.browser.esm.js"),ethers__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@ethersproject/units/lib.esm/index.js"),_thirdweb_dev_storage__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@thirdweb-dev/storage/dist/thirdweb-dev-storage.esm.js"),console=__webpack_require__("./node_modules/console-browserify/index.js");function detectContractFeature(contractWrapper,featureName){return(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.ai)(contractWrapper.abi,featureName,contractWrapper.extensions)}function hasFunction(functionName,contractWrapper){return functionName in contractWrapper.readContract.functions}class ContractMetadata{featureName=_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.cJ.name;constructor(contractWrapper,schema,storage){this.contractWrapper=contractWrapper,this.schema=schema,this.storage=storage}parseOutputMetadata(metadata){return this.schema.output.parseAsync(metadata)}parseInputMetadata(metadata){return this.schema.input.parseAsync(metadata)}async get(){let data;if(this.supportsContractMetadata(this.contractWrapper)){const uri=await this.contractWrapper.read("contractURI",[]);uri&&uri.includes("://")&&(data=await this.storage.downloadJSON(uri))}if(!data)try{let contractName,contractSymbol,publishedMetadata;try{hasFunction("name",this.contractWrapper)&&(contractName=await this.contractWrapper.read("name",[]))}catch(err){}try{hasFunction("symbol",this.contractWrapper)&&(contractSymbol=await this.contractWrapper.read("symbol",[]))}catch(err){}try{publishedMetadata=await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.K)(this.contractWrapper.address,this.contractWrapper.getProvider(),this.storage,this.contractWrapper.options)}catch(err){}data={name:contractName||publishedMetadata?.name,symbol:contractSymbol,description:publishedMetadata?.info.title}}catch(e){throw new Error("Could not fetch contract metadata")}return this.parseOutputMetadata(data)}set=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.f)((async metadata=>{const uri=await this._parseAndUploadMetadata(metadata),wrapper=this.contractWrapper;if(this.supportsContractMetadata(wrapper))return _transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"setContractURI",args:[uri],parse:receipt=>({receipt,data:this.get})});throw new _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.x(_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.cJ)}));update=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.f)((async metadata=>await this.set.prepare({...await this.get(),...metadata})));async _parseAndUploadMetadata(metadata){const parsedMetadata=await this.parseInputMetadata(metadata);return this.storage.upload(parsedMetadata)}supportsContractMetadata(contractWrapper){return detectContractFeature(contractWrapper,"ContractMetadata")}}class ContractEvents{constructor(contractWrapper){this.contractWrapper=contractWrapper}addTransactionListener(listener){this.contractWrapper.addListener(_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.aZ.Transaction,listener)}removeTransactionListener(listener){this.contractWrapper.off(_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.aZ.Transaction,listener)}addEventListener(eventName,listener){const event=this.contractWrapper.readContract.interface.getEvent(eventName),filter={address:this.contractWrapper.address,topics:[this.contractWrapper.readContract.interface.getEventTopic(event)]},wrappedListener=log=>{const parsedLog=this.contractWrapper.readContract.interface.parseLog(log);listener(this.toContractEvent(parsedLog.eventFragment,parsedLog.args,log))};return this.contractWrapper.getProvider().on(filter,wrappedListener),()=>{this.contractWrapper.getProvider().off(filter,wrappedListener)}}listenToAllEvents(listener){const filter={address:this.contractWrapper.address},wrappedListener=log=>{try{const parsedLog=this.contractWrapper.readContract.interface.parseLog(log);listener(this.toContractEvent(parsedLog.eventFragment,parsedLog.args,log))}catch(e){console.error("Could not parse event:",log,e)}};return this.contractWrapper.getProvider().on(filter,wrappedListener),()=>{this.contractWrapper.getProvider().off(filter,wrappedListener)}}removeEventListener(eventName,listener){const event=this.contractWrapper.readContract.interface.getEvent(eventName);this.contractWrapper.readContract.off(event.name,listener)}removeAllListeners(){this.contractWrapper.readContract.removeAllListeners();const filter={address:this.contractWrapper.address};this.contractWrapper.getProvider().removeAllListeners(filter)}async getAllEvents(){let filters=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{fromBlock:0,toBlock:"latest",order:"desc"};const orderedEvents=(await this.contractWrapper.readContract.queryFilter({},filters.fromBlock,filters.toBlock)).sort(((a,b)=>"desc"===filters.order?b.blockNumber-a.blockNumber:a.blockNumber-b.blockNumber));return this.parseEvents(orderedEvents)}async getEvents(eventName){let options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromBlock:0,toBlock:"latest",order:"desc"};const eventInterface=this.contractWrapper.readContract.interface.getEvent(eventName),args=options.filters?eventInterface.inputs.map((e=>options.filters[e.name])):[],filter=this.contractWrapper.readContract.filters[eventInterface.name](...args),orderedEvents=(await this.contractWrapper.readContract.queryFilter(filter,options.fromBlock,options.toBlock)).sort(((a,b)=>"desc"===options.order?b.blockNumber-a.blockNumber:a.blockNumber-b.blockNumber));return this.parseEvents(orderedEvents)}parseEvents(events){return events.map((e=>{const transaction=Object.fromEntries(Object.entries(e).filter((a=>"function"!=typeof a[1]&&"args"!==a[0])));if(e.args){const entries=Object.entries(e.args),args=entries.slice(entries.length/2,entries.length),data={};for(const[key,value]of args)data[key]=value;return{eventName:e.event||"",data,transaction}}return{eventName:e.event||"",data:{},transaction}}))}toContractEvent(event,args,rawLog){const transaction=Object.fromEntries(Object.entries(rawLog).filter((a=>"function"!=typeof a[1]&&"args"!==a[0]))),results={};return event.inputs.forEach(((param,index)=>{if(Array.isArray(args[index])){const components=param.components;if(components){const arr=args[index];if("tuple[]"===param.type){const objArray=[];for(let i=0;i<arr.length;i++){const tuple=arr[i],obj={};for(let j=0;j<components.length;j++){obj[components[j].name]=tuple[j]}objArray.push(obj)}results[param.name]=objArray}else{const obj={};for(let i=0;i<components.length;i++){obj[components[i].name]=arr[i]}results[param.name]=obj}}}else results[param.name]=args[index]})),{eventName:event.name,data:results,transaction}}}class GasCostEstimator{constructor(contractWrapper){this.contractWrapper=contractWrapper}async gasCostOf(fn,args){return function toEther(amount){return ethers__WEBPACK_IMPORTED_MODULE_2__.formatEther(amount)}(await(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.contractWrapper.getProvider(),await this.contractWrapper.populateTransaction(fn,args)))}async gasLimitOf(fn,args){return this.contractWrapper.estimateGas(fn,args)}async currentGasPriceInGwei(){const price=await this.contractWrapper.getProvider().getGasPrice();return ethers__WEBPACK_IMPORTED_MODULE_2__.formatUnits(price,"gwei")}}class ContractAppURI{featureName=_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.cK.name;constructor(contractWrapper,metadata,storage){this.contractWrapper=contractWrapper,this.metadata=metadata,this.storage=storage}async get(){return detectContractFeature(this.contractWrapper,"AppURI")?await this.contractWrapper.read("appURI",[]):(0,_thirdweb_dev_storage__WEBPACK_IMPORTED_MODULE_3__.Rz)((await this.metadata.get()).app_uri||"",this.storage.getGatewayUrls())}set=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.f)((async appURI=>detectContractFeature(this.contractWrapper,"AppURI")?_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_1__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"setAppURI",args:[appURI]}):await this.metadata.update.prepare({app_uri:appURI})))}},"./node_modules/@thirdweb-dev/sdk/dist/contract-roles-71988d2e.browser.esm.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>ContractRoles});var tiny_invariant__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/tiny-invariant/dist/esm/tiny-invariant.js"),_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/index-33cd3415.browser.esm.js"),_contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/contract-appuri-5c40af52.browser.esm.js"),_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/transactions-72f9603c.browser.esm.js"),_fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@thirdweb-dev/sdk/dist/fetchCurrencyValue-32d08b05.browser.esm.js");class ContractRoles{featureName=_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.d4.name;constructor(contractWrapper,roles){this.contractWrapper=contractWrapper,this.roles=roles}async getAll(){(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_1__.A)(this.roles.length,"this contract has no support for roles");const roles={},entries=Object.entries(this.roles);return(await Promise.all(entries.map((_ref=>{let[,role]=_ref;return this.get(role)})))).forEach(((item,index)=>roles[entries[index][1]]=item)),roles}async get(role){(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_1__.A)(this.roles.includes(role),`this contract does not support the "${role}" role`);const wrapper=this.contractWrapper;if((0,_contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.h)("getRoleMemberCount",wrapper)&&(0,_contract_appuri_5c40af52_browser_esm_js__WEBPACK_IMPORTED_MODULE_2__.h)("getRoleMember",wrapper)){const roleHash=(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.H)(role),count=(await wrapper.read("getRoleMemberCount",[roleHash])).toNumber();return await Promise.all(Array.from(Array(count).keys()).map((i=>wrapper.read("getRoleMember",[roleHash,i]))))}throw new Error("Contract does not support enumerating roles. Please implement IPermissionsEnumerable to unlock this functionality.")}setAll=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.f)((async(rolesWithAddresses,actingAddress)=>{const connectedWalletAddress=actingAddress||await this.contractWrapper.getSignerAddress(),contractEncoder=new _fetchCurrencyValue_32d08b05_browser_esm_js__WEBPACK_IMPORTED_MODULE_4__.C(this.contractWrapper),roles=Object.keys(rolesWithAddresses);(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_1__.A)(roles.length,"you must provide at least one role to set"),(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_1__.A)(roles.every((role=>this.roles.includes(role))),"this contract does not support the given role");const currentRoles=await this.getAll(),encoded=[],sortedRoles=roles.sort((role=>"admin"===role?1:-1));for(let i=0;i<sortedRoles.length;i++){const role=sortedRoles[i],[addresses,currentAddresses]=await Promise.all([Promise.all(rolesWithAddresses[role]?.map((addressOrEns=>(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.aL)(addressOrEns)))||[]),Promise.all(currentRoles[role]?.map((addressOrEns=>(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.aL)(addressOrEns)))||[])]),toAdd=addresses.filter((address=>!currentAddresses.includes(address))),toRemove=currentAddresses.filter((address=>!addresses.includes(address)));if(toRemove.length>1){const index=toRemove.indexOf(connectedWalletAddress);index>-1&&(toRemove.splice(index,1),toRemove.push(connectedWalletAddress))}if(toAdd.length&&toAdd.forEach((address=>{encoded.push(contractEncoder.encode("grantRole",[(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.H)(role),address]))})),toRemove.length){(await Promise.all(toRemove.map((address=>this.getRevokeRoleFunctionName(address))))).forEach(((revokeFunctionName,index)=>encoded.push(contractEncoder.encode(revokeFunctionName,[(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.H)(role),toRemove[index]]))))}}return _transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"multicall",args:[encoded]})}));async verify(roles,address){await Promise.all(roles.map((async role=>{const[members,resolvedAddress]=await Promise.all([this.get(role),(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.aL)(address)]);if(!members.map((a=>a.toLowerCase())).includes(resolvedAddress.toLowerCase()))throw new _index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.o(resolvedAddress,role)})))}grant=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.f)((async(role,address)=>{(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_1__.A)(this.roles.includes(role),`this contract does not support the "${role}" role`);const resolvedAddress=await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.aL)(address);return _transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:"grantRole",args:[(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.H)(role),resolvedAddress]})}));revoke=(0,_transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.f)((async(role,address)=>{(0,tiny_invariant__WEBPACK_IMPORTED_MODULE_1__.A)(this.roles.includes(role),`this contract does not support the "${role}" role`);const resolvedAddress=await(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.aL)(address),revokeFunctionName=await this.getRevokeRoleFunctionName(resolvedAddress);return _transactions_72f9603c_browser_esm_js__WEBPACK_IMPORTED_MODULE_3__.T.fromContractWrapper({contractWrapper:this.contractWrapper,method:revokeFunctionName,args:[(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.H)(role),resolvedAddress]})}));async getRevokeRoleFunctionName(address){const[resolvedAddress,signerAddress]=await Promise.all([(0,_index_33cd3415_browser_esm_js__WEBPACK_IMPORTED_MODULE_0__.aL)(address),this.contractWrapper.getSignerAddress()]);return signerAddress.toLowerCase()===resolvedAddress.toLowerCase()?"renounceRole":"revokeRole"}}}}]);